<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="author" content="yushi4ka">
    <link rel="icon" type="image/x-icon" href="https://yushi4ka.github.io/projects_files/HTML5-Clicker/site.ico">
    <title>Кликер</title>
    <style>
        :root {
            --primary-color: #ffaa00;
            --bg-color: #222222;
            --panel-color: #272727;
            --text-color: #ffffff;
            --border-color: rgba(255, 255, 255, 0.2);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: var(--bg-color);
            color: var(--text-color);
            user-select: none;
            overflow-x: hidden;
            min-height: 100vh;
        }

        /* Основной контейнер игры */
        #game-container {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            max-width: 1000px;
            margin: 0 auto;
            position: relative;
            min-height: 100vh;
        }

        /* Заголовок зоны */
        #zone-title {
            font-size: clamp(24px, 5vw, 50px);
            font-weight: bold;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.5);
            margin-bottom: 20px;
            text-align: center;
        }

        /* Кнопки меню (мобильные) */
        .mobile-menu-button {
            position: fixed;
            bottom: 20px;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            background-color: var(--panel-color);
            border: 2px solid var(--border-color);
            color: var(--primary-color);
            font-weight: bold;
            font-size: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            z-index: 50;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            transition: all 0.3s;
        }

        .mobile-menu-button:hover {
            transform: scale(1.1);
        }

        #shop-button {
            right: 20px;
        }

        #pickaxes-button {
            right: 90px;
        }

        #news-button {
            left: 20px;
        }

        /* Мобильное меню */
        .mobile-menu {
            position: fixed;
            bottom: 90px;
            width: calc(100% - 40px);
            max-width: 400px;
            max-height: 60vh;
            background-color: var(--panel-color);
            border-radius: 15px;
            padding: 15px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            z-index: 49;
            transform: translateY(150%);
            transition: transform 0.3s ease;
            overflow-y: auto;
        }

        .mobile-menu.active {
            transform: translateY(0);
        }

        /* Общие стили для магазина и селектора кирок */
        #shop-container, #pickaxe-selector-container {
            background-color: var(--panel-color);
            border-radius: 15px;
            box-shadow: 0 0 8px rgba(0, 0, 0, 0.3);
            padding: 15px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 300px;
        }

        /* Только десктоп */
        @media (min-width: 768px) {
            #game-container {
                flex-direction: row;
                align-items: flex-start;
                justify-content: center;
                gap: 20px;
                padding-top: 50px;
            }

            #zone-title {
                position: absolute;
                top: 10px;
                width: 100%;
                text-align: center;
            }

            #shop-container {
                order: 1;
                position: static;
                transform: none;
                max-height: 70vh;
                overflow-y: auto;
            }

            #pickaxe-selector-container {
                order: -1;
                position: static;
                transform: none;
            }

            .mobile-menu-button {
                display: none;
            }

            .mobile-menu {
                display: none;
            }
        }

        /* Зона клика */
        #click-zone {
            width: clamp(100px, 30vw, 150px);
            height: clamp(100px, 30vw, 150px);
            background-color: #8B4513;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            overflow: hidden;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            border: 3px solid var(--border-color);
            margin: 20px 0;
            user-select: none;
            transition: background-color 0.3s, transform 0.2s;
        }

        #click-zone.click-animation {
            animation: clickEffect 0.3s;
        }

        @keyframes clickEffect {
            0% { transform: scale(1); }
            50% { transform: scale(0.9); }
            100% { transform: scale(1); }
        }

        /* Полоска HP */
        #hp-bar-container {
            width: clamp(150px, 80%, 250px);
            height: 25px;
            background-color: #b2332a;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 20px;
            position: relative;
            border: 3px solid rgba(0, 0, 0, 0.2);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.3);
        }

        #hp-bar {
            height: 100%;
            width: 100%;
            background-color: #e43c30;
            transition: width 0.3s;
        }

        #hp-text {
            position: absolute;
            width: 100%;
            text-align: center;
            line-height: 25px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: bold;
            z-index: 2;
            font-size: clamp(12px, 3vw, 16px);
        }

        /* Отображение монет */
        #coins {
            font-size: clamp(20px, 5vw, 30px);
            font-weight: bold;
            margin: 10px 0;
            color: var(--primary-color);
            text-align: center;
        }

        /* Анимация монет */
        .coin-animation {
            position: absolute;
            font-size: 20px;
            color: var(--primary-color);
            font-weight: bold;
            animation: coinFly 1s forwards;
            pointer-events: none;
            z-index: 10;
        }

        @keyframes coinFly {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-50px); opacity: 0; }
        }

        /* Текущая кирка */
        #current-pickaxe {
            margin: 20px 0;
            font-size: clamp(16px, 4vw, 20px);
            color: var(--text-color);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-wrap: wrap;
            text-align: center;
        }

        #pickaxe-color {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            margin-right: 10px;
            border: 2px solid var(--border-color);
        }

        /* Магазин */
        .shop-item {
            display: flex;
            align-items: center;
            padding: 10px;
            margin-bottom: 10px;
            background-color: #404040;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
        }

        .shop-item.available:hover {
            background-color: #505050;
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .shop-item.unavailable {
            opacity: 0.6;
            cursor: not-allowed;
            background-color: #333333;
        }

        .shop-item.owned {
            background-color: #222222;
            position: relative;
        }

        .shop-item.owned::after {
            content: "✓";
            position: absolute;
            right: 15px;
            color: #4CAF50;
            font-size: 20px;
            font-weight: bold;
        }

        .item-color {
            width: 25px;
            height: 25px;
            border-radius: 50%;
            margin-right: 10px;
            border: 2px solid var(--border-color);
        }

        .item-name {
            flex: 1;
            font-weight: bold;
            font-size: clamp(14px, 3vw, 16px);
        }

        .item-price {
            color: var(--primary-color);
            font-weight: bold;
            margin-left: 10px;
            font-size: clamp(14px, 3vw, 16px);
        }

        /* Иконки кирок */
        .pickaxe-icon {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: 3px solid var(--border-color);
            cursor: pointer;
            transition: all 0.2s;
            margin: 5px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 12px;
        }

        .pickaxe-icon:hover {
            transform: scale(1.1);
        }

        .pickaxe-icon.selected {
            border-color: var(--primary-color);
            box-shadow: 0 0 10px var(--primary-color);
        }

        /* Новости */
        .blur-background {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            backdrop-filter: blur(5px);
            z-index: 98;
            display: none;
        }

        body.blurred .blur-background {
            display: block;
        }

        #news-modal {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 90%;
            max-width: 500px;
            max-height: 80vh;
            background-color: var(--panel-color);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            z-index: 99;
            display: none;
            overflow-y: auto;
        }

        #news-modal h2 {
            color: var(--primary-color);
            margin-top: 0;
            text-align: center;
        }

        #news-modal h3 {
            color: #909090;
            margin-top: 0;
            text-align: center;
        }

        #news-modal mark {
            background-color: #272727;
            color: #cccccc;
            border-radius: 5px;
            border: 2px solid rgba(0, 0, 0, 0.5);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
            margin-top: 0;
            text-align: center;
        }

        #news-content {
            color: var(--text-color);
            line-height: 1.5;
        }

        #close-news {
            position: absolute;
            top: 10px;
            right: 10px;
            background: none;
            border: none;
            color: var(--text-color);
            font-size: 24px;
            cursor: pointer;
        }

        /* Уведомления */
        .notification-container {
            position: fixed;
            top: 20px;
            right: 20px;
            width: 90%;
            max-width: 300px;
            z-index: 100;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .notification {
            background-color: var(--panel-color);
            color: var(--text-color);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            animation: slideIn 0.3s forwards, fadeOut 0.5s forwards 2.5s;
            transform: translateX(100%);
            opacity: 0;
            position: relative;
            overflow: hidden;
            border-left: 4px solid var(--primary-color);
        }
        
        .notification.success {
            border-left-color: #4CAF50;
        }
        
        .notification.error {
            border-left-color: #f44336;
        }
        
        .notification.warning {
            border-left-color: #ff9800;
        }
        
        .notification-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--primary-color);
        }
        
        .notification.success .notification-title {
            color: #4CAF50;
        }
        
        .notification.error .notification-title {
            color: #f44336;
        }
        
        .notification.warning .notification-title {
            color: #ff9800;
        }
        
        .notification-content {
            font-size: 14px;
        }
        
        .notification-progress {
            position: absolute;
            bottom: 0;
            left: 0;
            height: 3px;
            background-color: rgba(255, 255, 255, 0.2);
            width: 100%;
        }
        
        .notification-progress-bar {
            height: 100%;
            background-color: var(--primary-color);
            width: 100%;
            animation: progressBar 3s linear forwards;
        }
        
        .notification.success .notification-progress-bar {
            background-color: #4CAF50;
        }
        
        .notification.error .notification-progress-bar {
            background-color: #f44336;
        }
        
        .notification.warning .notification-progress-bar {
            background-color: #ff9800;
        }
        
        @keyframes slideIn {
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes fadeOut {
            to { opacity: 0; }
        }
        
        @keyframes progressBar {
            from { width: 100%; }
            to { width: 0%; }
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="zone-title"><b>ZONE_NAME</b></div>
        
        <!-- Основная игровая зона -->
        <div id="click-zone">
            <div id="click-text">КЛИК</div>
        </div>
        
        <div id="hp-bar-container">
            <div id="hp-text">ZONE_HP</div>
            <div id="hp-bar"></div>
        </div>
        
        <div id="coins">PLAYER_COINS</div>
        
        <div id="current-pickaxe">
            <div id="pickaxe-color" style="background-color: #8B4513"></div>
            <span>Деревянная Кирка (1⛏️)</span>
        </div>
        
        <!-- Десктоп версия магазина и кирок -->
        <div id="shop-container" class="desktop-only">
            <h2>Магазин</h2>
            <div id="shop-items"></div>
        </div>
        
        <div id="pickaxe-selector-container" class="desktop-only">
            <h2>Ваши кирки</h2>
            <div id="pickaxe-selector"></div>
        </div>
        
        <!-- Мобильньные кнопки меню -->
        <div id="shop-button" class="mobile-menu-button">🛒</div>
        <div id="pickaxes-button" class="mobile-menu-button">⛏️</div>
        <div id="news-button" class="mobile-menu-button">!</div>
        
        <!-- Мобильные меню -->
        <div id="mobile-shop" class="mobile-menu">
            <h2>Магазин</h2>
            <div id="mobile-shop-items"></div>
        </div>
        
        <div id="mobile-pickaxes" class="mobile-menu">
            <h2>Ваши кирки</h2>
            <div id="mobile-pickaxe-selector"></div>
        </div>
    </div>
    
    <!-- Новости -->
    <div class="blur-background"></div>
    <div id="news-modal">
        <button id="close-news">×</button>
        <h2>Новости Кликера</h2>
        <h3>v0.1.8</h3>
        <div id="news-content">
            <p>Добро пожаловать в игру!</p>
            <p>Последние обновления:</p>
            <ul>
                <li><mark>v0.1.8</mark> - <b>Добавлена</b> поддержка мобильных устройств.</li>
                <li><mark>v0.1.6</mark> - <b>Обновлена</b> система сохранений.</li>
                <li><mark>v0.1.6</mark> - <b>Добавлена</b> система уведомлений.</li>
            </ul>
        </div>
    </div>
    
    <!-- Уведомления -->
    <div class="notification-container" id="notification-container"></div>

    <script>
        const clickZone = document.getElementById('click-zone');
        const hpBar = document.getElementById('hp-bar');
        const hpText = document.getElementById('hp-text');
        const coinsDisplay = document.getElementById('coins');
        const zoneTitle = document.getElementById('zone-title');
        const shopItemsContainer = document.getElementById('shop-items');
        const mobileShopItemsContainer = document.getElementById('mobile-shop-items');
        const pickaxeColor = document.getElementById('pickaxe-color');
        const currentPickaxeText = document.querySelector('#current-pickaxe span');
        const pickaxeSelector = document.getElementById('pickaxe-selector');
        const mobilePickaxeSelector = document.getElementById('mobile-pickaxe-selector');

        const shopButton = document.getElementById('shop-button');
        const pickaxesButton = document.getElementById('pickaxes-button');
        const mobileShop = document.getElementById('mobile-shop');
        const mobilePickaxes = document.getElementById('mobile-pickaxes');

        const zoneslist = [
            { id: 1, maxHp: 15, coins: 1, name: "Каменная Зона", color: "#9E9E9E", pickaxeRequired: 0 },
            { id: 2, maxHp: 30, coins: 2, name: "Медная Зона", color: "#B87333", pickaxeRequired: 1 },
            { id: 3, maxHp: 50, coins: 3, name: "Оловянная Зона", color: "#7F7F7F", pickaxeRequired: 2 },
            { id: 4, maxHp: 70, coins: 4, name: "Железная Зона", color: "#A19D94", pickaxeRequired: 2 },
            { id: 5, maxHp: 90, coins: 6, name: "Платиновая Зона", color: "#C0C0C0", pickaxeRequired: 3 },
            { id: 6, maxHp: 100, coins: 8, name: "Золотая Зона", color: "#FFD700", pickaxeRequired: 4 },
            { id: 7, maxHp: 150, coins: 10, name: "Алмазная Зона", color: "#00BFFF", pickaxeRequired: 4 },
            { id: 8, maxHp: 200, coins: 15, name: "Изумрудная Зона", color: "#50C878", pickaxeRequired: 4 },
            { id: 9, maxHp: 300, coins: 20, name: "Титановая Зона", color: "#878681", pickaxeRequired: 6 },
            { id: 10, maxHp: 500, coins: 30, name: "Рубиновая Зона", color: "#E0115F", pickaxeRequired: 7 },
            { id: 11, maxHp: 600, coins: 35, name: "Мифриловая Зона", color: "#5F9EA0", pickaxeRequired: 7 },
            { id: 12, maxHp: 700, coins: 40, name: "Сапфировая Зона", color: "#0F52BA", pickaxeRequired: 8 },
            { id: 13, maxHp: 750, coins: 45, name: "Обсидиановая Зона", color: "#2f0963", pickaxeRequired: 8 },
            { id: 14, maxHp: 1000, coins: 50, name: "Лунная Зона", color: "#C0C0E0", pickaxeRequired: 9 },
            { id: 15, maxHp: 1500, coins: 60, name: "Солнечная Зона", color: "#FFD700", pickaxeRequired: 10 }
        ];

        const pickaxes = [
            { id: 0, name: "Деревянная Кирка", color: "#8B4513", damage: 1, price: 0 },
            { id: 1, name: "Каменная Кирка", color: "#9E9E9E", damage: 2, price: 10, required: null },
            { id: 2, name: "Медная Кирка", color: "#B87333", damage: 3, price: 20, required: 1 },
            { id: 3, name: "Железная Кирка", color: "#A19D94", damage: 4, price: 40, required: 2 },
            { id: 4, name: "Платиновая Кирка", color: "#C0C0C0", damage: 5, price: 60, required: 3 },
            { id: 5, name: "Золотая Кирка", color: "#FFD700", damage: 6, price: 80, required: 4 },
            { id: 6, name: "Алмазная Кирка", color: "#00BFFF", damage: 8, price: 100, required: 5 },
            { id: 7, name: "Титановая Кирка", color: "#878681", damage: 12, price: 200, required: 6 },
            { id: 8, name: "Мифриловая Кирка", color: "#5F9EA0", damage: 14, price: 300, required: 7 },
            { id: 9, name: "Обсидиановая Кирка", color: "#2f0963", damage: 16, price: 400, required: 8 },       
            { id: 10, name: "Лунная Кирка", color: "#C0C0E0", damage: 18, price: 600, required: 9 },
            { id: 11, name: "Солнечная Кирка", color: "#FFD700", damage: 20, price: 1000, required: 10 }
        ];

        const zoneTiers = [
            { minPickaxe: 0, maxPickaxe: 1, zones: [1] },
            { minPickaxe: 1, maxPickaxe: 2, zones: [1, 2, 3] },
            { minPickaxe: 2, maxPickaxe: 3, zones: [2, 4, 5] },
            { minPickaxe: 3, maxPickaxe: 4, zones: [4, 5, 6] },
            { minPickaxe: 4, maxPickaxe: 5, zones: [6, 7, 8] },
            { minPickaxe: 6, maxPickaxe: 7, zones: [8, 9, 10] },
            { minPickaxe: 7, maxPickaxe: 8, zones: [9, 10, 11] },
            { minPickaxe: 8, maxPickaxe: 9, zones: [11, 12, 13] },
            { minPickaxe: 9, maxPickaxe: 10, zones: [12, 13, 14] },
            { minPickaxe: 10, maxPickaxe: 11, zones: [13, 14, 15] }
        ];

        let currentZone = zoneslist[0];
        let hp = currentZone.maxHp;
        let maxHp = currentZone.maxHp;
        let coins = 0;
        let currentPickaxe = pickaxes[0];
        let ownedPickaxes = [0];

        function generateToken() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
            let token = '';
            for (let i = 0; i < 27; i++) {
                token += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            return token;
        }

        function saveGame() {
            const gameData = {
                coins: coins,
                currentPickaxeId: currentPickaxe.id,
                ownedPickaxes: ownedPickaxes,
                currentZoneId: currentZone.id,
                hp: hp,
                maxHp: maxHp
            };
            
            const html5ClickerData = JSON.parse(localStorage.getItem('HTML5Clicker')) || {};
            
            if (!html5ClickerData.token) {
                html5ClickerData.token = generateToken();
            }
            
            html5ClickerData.gameData = gameData;
            
            localStorage.setItem('HTML5Clicker', JSON.stringify(html5ClickerData));
            
            const expiryDate = new Date();
            expiryDate.setDate(expiryDate.getDate() + 30);
            document.cookie = `HTML5Clicker=${encodeURIComponent(JSON.stringify(html5ClickerData))}; expires=${expiryDate.toUTCString()}; path=/`;
        }

        function loadGame() {
            let savedData = localStorage.getItem('HTML5Clicker');
            
            if (!savedData) {
                const cookies = document.cookie.split(';');
                for (let cookie of cookies) {
                    cookie = cookie.trim();
                    if (cookie.startsWith('HTML5Clicker=')) {
                        savedData = decodeURIComponent(cookie.substring('HTML5Clicker='.length));
                        break;
                    }
                }
            }
            
            if (!savedData) return false;
            
            try {
                const html5ClickerData = JSON.parse(savedData);
                const gameData = html5ClickerData.gameData;
                
                if (!gameData) return false;
                
                coins = gameData.coins || 0;
                currentPickaxe = pickaxes.find(p => p.id === gameData.currentPickaxeId) || pickaxes[0];
                ownedPickaxes = gameData.ownedPickaxes || [0];
                currentZone = zoneslist.find(z => z.id === gameData.currentZoneId) || zoneslist[0];
                hp = gameData.hp || currentZone.maxHp;
                maxHp = gameData.maxHp || currentZone.maxHp;
                
                return true;
            } catch (e) {
                console.error('Ошибка загрузки игры', e);
                return false;
            }
        }

        function updateHpBar() {
            const percentage = (hp / maxHp) * 100;
            hpBar.style.width = `${percentage}%`;
            hpText.textContent = `${hp}/${maxHp} HP`;
        }

        function spawnCoinAnimation(amount) {
            const coin = document.createElement('div');
            coin.className = 'coin-animation';
            coin.textContent = `+${amount}🪙`;
            clickZone.appendChild(coin);
            
            setTimeout(() => {
                coin.remove();
            }, 1000);
        }

        function getAvailableZones() {
            const currentTier = zoneTiers.find(tier => 
                currentPickaxe.id >= tier.minPickaxe && 
                currentPickaxe.id <= tier.maxPickaxe
            );
            
            if (currentTier) {
                return zoneslist.filter(zone => currentTier.zones.includes(zone.id));
            }
            
            const availableZones = zoneslist.filter(zone => zone.pickaxeRequired <= currentPickaxe.id);
            
            const zoneGroups = [];
            for (let i = 0; i < availableZones.length; i += 3) {
                zoneGroups.push(availableZones.slice(i, i + 3));
            }
            
            const pickaxeGroup = Math.floor(currentPickaxe.id / 3);
            
            return zoneGroups[pickaxeGroup] || 
                zoneGroups[zoneGroups.length - 1] || 
                availableZones;
        }

        function getRandomZone() {
            const availableZones = getAvailableZones();
            
            if (availableZones.length === 1) return availableZones[0];
            
            const zonesToPick = availableZones.filter(zone => zone.id !== currentZone.id);
            
            if (zonesToPick.length > 0) {
                return zonesToPick[Math.floor(Math.random() * zonesToPick.length)];
            }
            
            return availableZones[Math.floor(Math.random() * availableZones.length)];
        }

        function resetClickZone() {
            currentZone = getRandomZone();
            hp = currentZone.maxHp;
            maxHp = currentZone.maxHp;
            
            clickZone.style.backgroundColor = currentZone.color;
            zoneTitle.textContent = currentZone.name;
            zoneTitle.style.color = currentZone.color;
            updateHpBar();
            saveGame();
        }

        function updatePickaxeDisplay() {
            pickaxeColor.style.backgroundColor = currentPickaxe.color;
            currentPickaxeText.textContent = `${currentPickaxe.name} (${currentPickaxe.damage}⛏️)`;
            renderPickaxeSelector();
            saveGame();
        }

        function renderPickaxeSelector() {
            pickaxeSelector.innerHTML = '';
            mobilePickaxeSelector.innerHTML = '';
            
            ownedPickaxes.forEach(pickaxeId => {
                const pickaxe = pickaxes.find(p => p.id === pickaxeId);
                if (pickaxe) {
                    const icon = createPickaxeIcon(pickaxe);
                    pickaxeSelector.appendChild(icon);
                    
                    const mobileIcon = createPickaxeIcon(pickaxe);
                    mobilePickaxeSelector.appendChild(mobileIcon);
                }
            });
        }

        function createPickaxeIcon(pickaxe) {
            const icon = document.createElement('div');
            icon.className = `pickaxe-icon ${pickaxe.id === currentPickaxe.id ? 'selected' : ''}`;
            icon.style.backgroundColor = pickaxe.color;
            icon.title = `${pickaxe.name} (${pickaxe.damage}⛏️)`;
            
            icon.addEventListener('click', () => {
                if (pickaxe.id !== currentPickaxe.id) {
                    currentPickaxe = pickaxe;
                    updatePickaxeDisplay();
                    resetClickZone();
                    if (window.innerWidth < 768) {
                        mobilePickaxes.classList.remove('active');
                    }
                }
            });
            
            return icon;
        }

        function showNotification(title, message, type = 'info') {
            const container = document.getElementById('notification-container');
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            
            notification.innerHTML = `
                <div class="notification-title">${title}</div>
                <div class="notification-content">${message}</div>
                <div class="notification-progress">
                    <div class="notification-progress-bar"></div>
                </div>
            `;
            
            container.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        function renderShop() {
            shopItemsContainer.innerHTML = '';
            mobileShopItemsContainer.innerHTML = '';
            
            pickaxes.slice(1).forEach(item => {
                const canBuy = coins >= item.price && 
                            (item.required === null || ownedPickaxes.includes(item.required));
                const isOwned = ownedPickaxes.includes(item.id);
                
                const shopItem = createShopItem(item, canBuy, isOwned);
                shopItemsContainer.appendChild(shopItem);
                
                const mobileShopItem = createShopItem(item, canBuy, isOwned);
                mobileShopItemsContainer.appendChild(mobileShopItem);
            });
        }

        function createShopItem(item, canBuy, isOwned) {
            const shopItem = document.createElement('div');
            shopItem.className = `shop-item ${isOwned ? 'owned' : (canBuy ? 'available' : 'unavailable')}`;
            
            shopItem.innerHTML = `
                <div class="item-color" style="background-color: ${item.color}"></div>
                <div class="item-name">${item.name} (${item.damage}⛏️)</div>
                ${isOwned ? '' : `<div class="item-price">${item.price}🪙</div>`}
            `;
            
            if (canBuy && !isOwned) {
                shopItem.addEventListener('click', () => {
                    coins -= item.price;
                    coinsDisplay.textContent = `${coins}🪙`;
                    ownedPickaxes.push(item.id);
                    currentPickaxe = item;
                    
                    showNotification(
                        'Покупка', 
                        `Куплена ${item.name} за ${item.price}🪙`, 
                        'success'
                    );
                    
                    updatePickaxeDisplay();
                    renderShop();
                    resetClickZone();
                    
                    if (window.innerWidth < 768) {
                        mobileShop.classList.remove('active');
                    }
                });
            }
            
            return shopItem;
        }

        clickZone.addEventListener('click', (e) => {
            clickZone.classList.add('click-animation');
            setTimeout(() => {
                clickZone.classList.remove('click-animation');
            }, 300);
            
            hp -= currentPickaxe.damage;
            updateHpBar();
            
            if (hp <= 0) {
                coins += currentZone.coins;
                coinsDisplay.textContent = `${coins}🪙`;
                spawnCoinAnimation(currentZone.coins);
                renderShop();
                resetClickZone();
            }
            
            saveGame();
        });

        shopButton.addEventListener('click', () => {
            mobileShop.classList.toggle('active');
            mobilePickaxes.classList.remove('active');
        });

        pickaxesButton.addEventListener('click', () => {
            mobilePickaxes.classList.toggle('active');
            mobileShop.classList.remove('active');
        });

        document.addEventListener('click', (e) => {
            if (!mobileShop.contains(e.target) && e.target !== shopButton) {
                mobileShop.classList.remove('active');
            }
            if (!mobilePickaxes.contains(e.target) && e.target !== pickaxesButton) {
                mobilePickaxes.classList.remove('active');
            }
        });

        const newsButton = document.getElementById('news-button');
        const newsModal = document.getElementById('news-modal');
        const closeNews = document.getElementById('close-news');
        const blurBackground = document.querySelector('.blur-background');

        newsButton.addEventListener('click', () => {
            document.body.classList.add('blurred');
            newsModal.style.display = 'block';
        });

        closeNews.addEventListener('click', () => {
            document.body.classList.remove('blurred');
            newsModal.style.display = 'none';
        });

        window.addEventListener('click', (e) => {
            if (e.target === blurBackground) {
                document.body.classList.remove('blurred');
                newsModal.style.display = 'none';
            }
        });

        setInterval(saveGame, 60000);

        window.addEventListener('beforeunload', saveGame);

        function initGame() {
            if (!loadGame()) {
                currentZone = zoneslist[0];
                hp = currentZone.maxHp;
                maxHp = currentZone.maxHp;
                coins = 0;
                currentPickaxe = pickaxes[0];
                ownedPickaxes = [0];
            }
            
            updatePickaxeDisplay();
            resetClickZone();
            renderShop();
            coinsDisplay.textContent = `${coins}🪙`;
            
            if (window.innerWidth < 768) {
                document.getElementById('shop-container').style.display = 'none';
                document.getElementById('pickaxe-selector-container').style.display = 'none';
            } else {
                mobileShop.style.display = 'none';
                mobilePickaxes.style.display = 'none';
            }
        }

        window.addEventListener('load', initGame);

        window.addEventListener('resize', () => {
            if (window.innerWidth < 768) {
                document.getElementById('shop-container').style.display = 'none';
                document.getElementById('pickaxe-selector-container').style.display = 'none';
                mobileShop.style.display = 'block';
                mobilePickaxes.style.display = 'block';
            } else {
                document.getElementById('shop-container').style.display = 'block';
                document.getElementById('pickaxe-selector-container').style.display = 'block';
                mobileShop.style.display = 'none';
                mobilePickaxes.style.display = 'none';
                mobileShop.classList.remove('active');
                mobilePickaxes.classList.remove('active');
            }
        });
    </script>

</body>
</html>
